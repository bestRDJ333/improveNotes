# 多工與情境切換

<https://cythilya.github.io/2018/10/30/callback/> [你懂 JavaScript 嗎？#23 Callback]

### 特別拿出來寫就是覺得重要，希望能達到在工作上的多工目地，但不降低效率與成果

人類如何計劃和處理事情？假設有 A、B、C 三件工作，其中 B 必須等待 C 做完才能執行。大部份的人幾乎都是做 A，再做 C，等待 C 做完以後最後做 B。但對於可多工的人來說，卻可能是同時做 A 與 C（多工），等待 C 完成後做 B。

然而，多工真的存在於人腦嗎？答案是否定的，人腦只是使用快速的情境切換讓我們產生多工的錯覺。

例子，來看一下理科太太的「[男友真的沒在聽！戳破一心二用謊言](https://www.youtube.com/watch?v=QV7vHutswOY&t=22s)」。

----

## 情境切換（Context Switch）

剛剛提到，多工是來自於可快速在不同情境間切換，而「情境切換」就是指在兩個以上的工作間來回切換，而這些工作被切割成許多個小片段，並以這些片段為單位被輪流處理，由於切換的速度很快，因此產生多工的錯覺。

關於多工可參考作業系統的 [Process & Thread Management](http://www.csie.ntnu.edu.tw/~swanky/os/chap4.htm)，好懷念恐龍本呀

聽起來很像是[事件迴圈（event loop）](https://cythilya.github.io/2018/10/29/asynchrony-now-and-later/#事件迴圈event-loop)的運作方式，將程式切成許多小片段並放入事件迴圈佇列中等候處理，而我們並沒有同時處理 A 和 C，而是將 A 與 C 分別切成更小的片段 A1、A2、C1、C2。因此，上面的三件工作可以這樣的方式交互執行：**A1 -> C1 -> A2 -> C2 -> B**，這樣就看起來很像多工，但其實仍只是一次完成一件（小）事情而已。

```
A [A1, A2, A3, .....]

C [C1, C2, C3, .....]

B 要等C完成
```





## 接回->Callback